<PACKAGE "SUBSYS">

<ENTRY SAVE-ME HERALD>

<DEFINE SAVE-ME ("BIND" O
		 FILE "OPTIONAL" (NM <7 <CHANNEL "READ" .FILE>>) MFILE
				 (BEFORE 1) (AFTER 1)
		      "AUX" (S <SNAME>) (S? <MEMQ !"; .FILE>) FNM)
	<EVAL .BEFORE .O>
	<COND (.S? <SET FNM .FILE>)
	      (ELSE <SET FNM <STRING .S !"; .FILE>>)>
	<SNAME "">
	<COND (<=? <FSAVE .FNM> "SAVED">
	       <EVAL .AFTER .O>
	       <SNAME .S>)
	      (ELSE
	       <EVAL .AFTER .O>
	       <COND (<ASSIGNED? MFILE> <HERALD .NM .MFILE>)
		     (ELSE <HERALD .NM>)>
	       <ERRET>)>>

<DEFINE HERALD (NM "OPTIONAL" (FILE <STRING "MUDSUB;" .NM " MESSAG">)
		"AUX" (I <OPEN "READ" .FILE>))
	<TERPRI>
	<PRINC .NM>
	<PRINC 
"  (MUDDLE.">
	<PRIN1 ,MUDDLE>
	<PRINC ")
">
	<COND (.I
	       <FILECOPY .I .OUTCHAN>
	       <CLOSE .I>)>
	,NULL>

<ENDPACKAGE>
>