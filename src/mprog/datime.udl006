<RPACKAGE ÙQ ‘ì˘±Q>ÒCE<ãNTRY DATE RTIME RTIME:SEC GETTIMEZONE FIX-DATE>

<TITLE DATE>
	<DECLARE ("VALUE" <LIST FIX FIX FIX> "OPTIONAL" <LIST FIX FIX FIX>)>
	<JUMPL	AB* RDARG>
	<PUSHJ	P* IDATE>
	<JRST	FINIS>

RDARG	<DPUSH	TP* (AB)>
     	<PUSHJ	P* IDATE1>
	<JRST	FINIS>

<INTERNAL-ENTRY IDATE1 1>
	<SUBM	M* (P)>
	<MOVE	B* (TP)>
	<JRST	DATER>

<INTERNAL-ENTRY IDATE 0>
	<SUBM	M* (P)>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* [<0>]>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* [<0>]>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* [<0>]>
	<MOVEI	A* 3>
	<PUSHJ	P* IILIST>
	<PUSH	TP* A>
	<PUSH	TP* B>

DATER	<*CALL	RDATEC>
	 <SETO	C*>
	<LDB	[<(*330700*) C>]>
	<MOVEM	1(B)>
	<HRRZ	B* (B)>
	<LDB	[<(*270400*) C>]>
	<MOVEM	1(B)>
	<HRRZ	B* (B)>
	<LDB	[<(*220500*) C>]>
	<MOVEM	1(B)>
	<POP	TP* B>
	<POP	TP* A>
	<JRST	MPOPJ>

RDATEC	<SETZ>
	<SIXBIT "RQDATE">
	<SETZM C>

<TITLE RTIME>
	<DECLARE ("VALUE" <LIST FIX FIX FIX> "OPTIONAL" <LIST FIX FIX FIX>)>
	<JUMPL	AB* RTARG>
	<PUSHJ	P* IRTIME>
	<JRST	FINIS>

RTARG	<DPUSH	TP* (AB)>
	<PUSHJ	P* IRTIME1>
	<JRST	FINIS>

<INTERNAL-ENTRY IRTIME1 1>
	<SUBM	M* (P)>
	<MOVE	B* (TP)>
	<JRST	RTIMER>

<INTERNAL-ENTRY IRTIME 0>
	<SUBM	M* (P)>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* [<0>]>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* [<0>]>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* [<0>]>
	<MOVEI	A* 3>
	<PUSHJ	P* IILIST>
	<PUSH	TP* A>
	<PUSH	TP* B>
RTIMER	<*CALL	RTIMEC>
	 <SETO	C*>
	<HRRZS	C>
	<IDIVI	C* 7200>
	<MOVEM	C* 1(B)>
	<MOVE	C* D>
	<HRRZ	B* (B)>
	<IDIVI	C* 120>
	<MOVEM	C* 1(B)>
	<HRRZ	B* (B)>
	<LSH	D* -1>
	<MOVEM	D* 1(B)>
	<POP	TP* B>
	<POP	TP* A>
	<JRST	MPOPJ>
RTIMEC	<SETZ>
	<SIXBIT "RQDATE">
	<SETZM C>

<TITLE RTIME:SEC>
	<DECLARE ("VALUE" FIX)>
	<PUSHJ	P* IRTIME:SEC>
	<JRST	FINIS>

<INTERNAL-ENTRY IRTIME:SEC 0>
	<SUBM	M* (P)>
	<SETZ	B*>
	<*CALL	[<SETZ>
		 <SIXBIT "RQDATE">
		 <SETZM B>]>
	<JFCL>
	<HRRZS	B>
	<LSH	B* -1>
	<MOVE	A* <TYPE-WORD FIX>>
	<JRST	MPOPJ>

<TITLE GETTIMEZONE>
	<DECLARE ("VALUE" STRING)>
	<PUSHJ	P* IGETTIMEZONE>
	<JRST	FINIS>

<INTERNAL-ENTRY IGETTIMEZONE 0>
	<SUBM	M* (P)>
	<*RYEAR C*>
	<MOVE	A* <MQUOTE "EDT"> -1>
	<MOVE	B* <MQUOTE "EDT">>
	<TLNN	C* *100000*>
	 <MOVE	B* <MQUOTE "EST">>
	<JRST	MPOPJ>

<TITLE	FIX-DATE>
	<DECLARE ("VALUE" FIX)>
	<PUSHJ	P* FIXD1>
	<JRST	FINIS>

<INTERNAL-ENTRY FIXD1 0>
	<*RDATE B*>
	<MOVEI C* 3>
	<MOVEI	E* 0>
	LOOP
	<SETZ A*>
	<LSHC A* 6>
	<MOVEI D* (A) -16>
	<IMULI D* 10.>
	<SETZ A*>
	<LSHC A* 6>
	<ADDI D* (A) -16>
	<IMULI	E* 100.>
	<ADDI	E* (D)>
	<SOJG	C* LOOP>
	<MOVE	B* E>
	<MOVSI	A* <TYPE-CODE FIX>> 
	<POPJ	P*>

<END>

<ENDPACKAGE>