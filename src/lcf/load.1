;"-*-Muddle-*-"
;"Load all the Zork source files and dump out a Muddle image."

<DEFINE VFLOAD (NAME)
  <PRINC <STRING "Loading " .NAME "...">>
  <FLOAD .NAME>
  <TERPRI>>

<SETG NULL!- <INSERT <STRING <ASCII 127>> <ROOT>>>

;"Stub out LSRTNS, which we don't have"
<DEFINE USE (NAME) <>>
<DEFINE LSR-ENTRY (UNAME) <>>

<VFLOAD "PRIM">
<VFLOAD "DEFS">
<VFLOAD "MAKSTR">
<VFLOAD "TELMID BINARY">
<VFLOAD "TELMDL">
<VFLOAD "PARSER">
<VFLOAD "MELEE">

<VFLOAD "ACT1">
<VFLOAD "ACT2">
<VFLOAD "ACT3">
;"Disable the endgame since it won't fit in memory"
; <VFLOAD "ACT4">
<SETG END-GAME-EXISTS? <>>

<VFLOAD "ROOMS">
<VFLOAD "DUNG">

;"Undefine stuff we no longer need from MAKSTR"
<GUNASSIGN MPOBLIST>
<GUNASSIGN PINSERT>
<GUNASSIGN CEVENT>
<GUNASSIGN CEXIT>
<GUNASSIGN DOOR>
<GUNASSIGN EXIT>
<GUNASSIGN ROOM>
<GUNASSIGN FIND-PREP>
<GUNASSIGN ADD-ACTION>
<GUNASSIGN ADD-DIRECTIONS>
<GUNASSIGN DSYNONYM>
<GUNASSIGN VSYNONYM>
<GUNASSIGN ADD-BUZZ>
<GUNASSIGN ADD-ZORK>
<GUNASSIGN SYNONYM>
<GUNASSIGN ADD-DEMON>
<GUNASSIGN ADD-ACTOR>
<GUNASSIGN SADD-ACTION>
<GUNASSIGN 1ADD-ACTION>
<GUNASSIGN 1NRADD-ACTION>
<GUNASSIGN MAKE-ACTION>
<GUNASSIGN ADD-BUNCHER>
<GUNASSIGN ADD-QUESTION>
<GUNASSIGN ADD-INQOBJ>
<GUNASSIGN GOBJECT>
<GUNASSIGN OBJECT>
<GUNASSIGN GET-OBJ>
<GUNASSIGN GET-ROOM>

<VFLOAD "IMPL">
<VFLOAD "SR">
<VFLOAD "SYNTAX">
<VFLOAD "UTIL">

<PRINC "Done - saving">
<TERPRI>
<SAVE-IT>
