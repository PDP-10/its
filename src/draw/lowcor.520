SUBTTL ASSEMBLY SWITCHES
;<DRAW>LOWCOR.FAI.134, 20-NOV-75 14:48:48, EDIT BY HELLIWELL
VERSION(LOWCOR,7)
;ASSEMBLY SWITCHES

IFN LIBSW!TWOSW,<
MD,<BEGIN D>
MPC,<BEGIN PC>
>;IFN LIBSW!TWOSW

;Initialization values for FLAGS,SCALE
DFLT0__<0,,MCHG!NEEDCL>
DFLTM__<MD,<BLOCS!PLOCS!CLOCS!>DEC,<XWINDOW!>CMUF,<DIAMONDS!JUNC3!>LWINDOW,,DEC,<SPACES!>0>
MPC,<	DFSCL__=2 >
MD,<	DFSCL__=16
	DEC,<	DFSCL__=8 >
>;MD

MPC,<SID_13>

;TURN SOME THINGS OFF IN CURRENT BLOCK
MPC,<
DEFINE PART<REPEAT 0>
DEFINE NOPART<REPEAT 0>
>;MPC
MD,<
DEFINE SHORT<REPEAT 0>
DEFINE NOSHORT<REPEAT 0>
DEFINE WAG<REPEAT 0>
DEFINE NOWAG<REPEAT 0>
>;MD
;VECTOR
STORAGE(PURE)

;;Setup start of assemblies in Layout mode
;;In TwoSegment mode, D and PC assembled to run at 400000
;;In LIBmode, reset PC to run in same place as D
;; (maybe reset location to page boundary?)
LAY,<
PASS1,<^^LAYBEG:>
PASS1,<^^LAY1S:>		;D start address
PASS2,<^^LAY2S:>		;PC start address

TWO,<PHASE 400000>

LIB,<
PASS2,<
GLOBAL LAYBEG
PHASE LAYBEG
>;PASS2
>;LIB

;;Define dispatch vector for layout version
DEFINE VECVAL(ADDR,VALUE)
<
PASS1,<^ADDR>JRST VALUE
>
;;Dispatch vectors for code that runs in either half
LAYVC0:	VECVAL	LAYSYM:,0		;SYMBOL TABLE POINTER IN THIS HALF
	VECVAL	.STRT:,STRT		;NORMAL START
	VECVAL	.STRTL:,STRTL		;START ONE SIDE
	VECVAL	SCRSET:,DSPOUT		;DISPLAY UPDATE
	VECVAL	.CONT:,CNTSAV		;CONTINUE LOC
	VECVAL	.BLCHK:,BLCHK		;BLINK CHECK
	VECVAL	.NOFST:,NOFSTA 		;GETFS  
	VECVAL	.NOBLK:,NOBLKA		;GET BLOCK
	VECVAL	REENTER:,%R		;REE
	VECVAL	.LERRET:,LERRET		;LOOKUP ERROR RETURN
	VECVAL	.UUOCON:,%UUOCON		;UUO'S

^LLAYVEC__.-LAYVC0
ONE,<PASS1,<LAYVEC:	BLOCK LLAYVEC  > >		;Saved D side xfer vector
>;LAY

NOLAY,<
.NOFST:	JRST NOFSTA
.NOBLK:	JRST NOBLKA
REENTER:JRST %R
.UUOCON:JRST %UUOCON
>;NOLAY
SUBTTL DEFINITIONS OF RANDOM PARAMETERS

MD,<
;NULL DIP NAME (BODY FOR VISUAL EFFECT ONLY!)
NULNAM__<ASCIZ/*/>
CABNAM__<ASCIZ/CABLE/>	;ALSO FORCES SIGNAL NAME "\C\" ON WIRE


;DRAWING SIZES ***********
;A	8.5 X 11
AH__=8500
AW__=11000
LABH__=1000	;HEIGHT OF REGULAR LABEL BOX

;X	8.5 X 11 WITH SMALLER LABEL BOX
XH__=8500
XW__=11000
LABX__=300	;HEIGHT OF XGP LABEL BOX

;B	11 X 17
BH__=11000
BW__=17000

;C	17 X 22
CH__=17000
CW__=22000

;D	22 X 34
DH__=22000
DW__=34000
;E	34 X 44
EH__=34000
EW__=44000
>;MD

;MAX STRING LENGTH IN WORDS FOR PERMUT
MXSTLN__=500/5

;BITS RETURNED BY PERMUT IN SAVBIT
GLB1__1		;1 UP ARROW
GLB2__2		;2 UP ARROWS
SGND__4		;GND
SPWR__10	;VCC
SHI__20		;+3
SNC__40		;NC
SCANON__100		;+5.0V AS OPPOSED TO VCC, THE "CANONICAL" FORM
MPC,<
;MAX PAD TYPE NUMBER THAT DOESN'T PRINT ON INPUT OR OUTPUT
STDMAX__3	;TYPE 3 FOR NOW

;1/2 THE WIDTH OF A CONNECTOR FINGER IN MILS
FWIDTH__=40

WAG,<
;ROUTER SPECIFICATIONS
ROUSCL__=20		;ROUTER HAS 50 MIL RESOLUTION
SIDDIF__=256		;THIS NUMBER IS THE DIFFERENCE BETWEEN SIDES
ROUXMT__=255		;MAXIMUM X VALUE (PER SIDE)
ROUXMM__=128		;OFFSET IN X (BECAUSE CENTER OF BOARD IS 0,0)
ROUXMB__2		;MINIMUM X VALUE
NODEC,<
ROUYMT__=199		;MAX Y VALUE
ROUYMM__=100		;OFFSET IN Y
>;NODEC
DEC,<
ROUYMT__=319
ROUYMM__=160
>;DEC
ROUYMB__2		;MINIMUM Y VALUE
ROUANY__ROUYMT+2	;SPECIFIES "ANY" PIN ON THIS EDGE
NEVERC__=1023		;SIGNAL # SPECIFIES NEVER CONNECT HERE
LCEDGE__=6		;FUDGE FOR LEFT CONNECTOR EDGE
NODEC,<RCEDGE__=243	>	;FUDGE FOR RIGHT CONNECTOR EDGE
DEC,<RCEDGE__=205	>
>;WAG
>;MPC

ROUTE,<
BYTSIZ__2		;USE 2 BIT BYTES FOR NOW!
%GRAIN__=50/5*2
%SEPAR__=50/5*2		;50 MILS MINIMUM BETWEEN WIRES!

%STEP__%SEPAR/%GRAIN

%XSIZ__=11000/5*2		;10 INCHES BY
%YSIZ__=16000/5*2		;16 INCHES

%ROW__%XSIZ/(%GRAIN*(=36/BYTSIZ))+1	;# OF WORDS PER ROW

%XCEN__%XSIZ/2
%YCEN__%YSIZ/2			;CENTER OF ARRAY
;HERE WE SET THE WEIGHTING FACTORS FOR DIFFERENT ROUTINGS!

%CNR__3		;CORNER COST
%FED__3		;FEED THROUGH COST
%BAK__2		;GOING AWAY FROM POINT COST
%SID__2		;ONE STEP ON WRONG SIDE COST
>;ROUTE


UML,<
;TYPE BITS FOUND IN LEFT HALF OF SECOND WORD
;OF WIRE HEADER IN WIRLST
INLD__400000		;INPUT LOAD
OUTLD__200000		;OUTPUT LOAD
NULLD__100000		;NO LOADING AT PRESENT
GND__40000		;GROUND CONNECTION
PWR__20000		;POWER CONNECTION
TRI__10000		;TRI-STATE OUTPUT
SHARE__4000		;SHARE INPUT LOAD BIT
OPENC__2000		;OPEN COLLECTOR OUTPUT
PULL__1000		;THIS OUTPUT IS A PULLUP

CBACK__2		;INTERNAL HEADER BIT FOR BACK STRAP CONNECTOR
CFRONT__1		;INTERNAL HEADER BIT FOR BACK PANEL CONNECTOR
>;UML
SUBTTL FILE EXTENSIONS
;DEFAULT DISK FILE EXTENSIONS & IO VERSION NUMBERS FOR MAINTAINING CONSISTENCY

COMMENT 
IOVER	Feature
------	--------------------
2	Flush rel vect to body text
3	Libraries
4	Vert text marked by 10 as opposed to 400000
	Flush format for #chars,#lines
10	Dip types

12	Body loc offset
13	List of types actually used from library
	Body bits

14	Macros
17	Pin pos,,pin name
20	New pin pos format
21	Great version # screwup
22	  "	"
23	Body loc char offset
	Dip type names as properties

26	??
27	Default package code remembered for types
	MPG21's loc format changed


MD,<IOVER__27>			;should be 27
MPC,<IOVER__21>

;IOVBRD AND MODIOV ARE DEFINED HERE BECAUSE JARVIS FUCKED UP AND USED IOVER 21
;TO INTRODUCE THE BOARD TYPE WHILE HELLIWELL WAS  USING THE SAME IOVER FOR THE
;NEW MODULE AND REVISION STUFF.  SINCE NO DRW FILES EXIST AT ITS WITH IOVER 22
;THE FOLLOWING KLUDGE WORKS.

ITS,<	BRDIOV__21	MODIOV__23	>
NOITS,<	BRDIOV__22	MODIOV__21	>
STANFO,<BRDIOV__21	>	;GRUMBLE, GRUMBLE
MPC,<BRDIOV__21>
MD,<	NOMVER__26	>	;NOMENCLATURE SEPERATE FROM BOARD TYPE

MD,<
EXTFIL__<'DRW'>			;DRAWING FILES
EXTEWR__EXTFIL			;EXTENSION FOR EWRITE COMMAND
CMU,<	EXTEWR__<'DRX'> >	;DON'T CLOBBER ORIGINAL IN AUTO EWRITE!
EXTLIB__EXTFIL			;LIBRARY SAME AS DRAWING
EXTBDL__<'LST'>			;BODY DEF LISTING
EXTDIP__<'DIP'>			;DIP DEF FILE
	DIPVER__5		;DIP FILE VERSION NUMBER
EXTWIR__<'WD '>			;WIRE LIST FILES
	WDVER__15	;WD
NODEC,<
EXTPLT__<'PLT'>			;PLOT FILES
>;NODEC
DEC,<
EXTPLT__<'DPL'>			;DEC ALREADY USES PLT
>;DEC
	PLTVER__15	;PLT
EXTPAR__<'DAT'>			;PARTITION OUTPUT FILE
EXTUML__<'UML'>			;UML INPUT FILE
EXTCHG__<'CHG'>			;CHG INPUT FILE
EXTCPN__<'CPN'>			;CPN INPUT FILE
>;MD
MPC,<
EXTFIL__<'PC '>			;DRAWING FILES
EXTEWR__EXTFIL			;EXTENSION FOR EWRITE COMMAND
CMU,<	EXTEWR__<'PD '> >	;DON'T CLOBBER ORIGINAL IN AUTO EWRITE
EXTWIR__<'WPC'>			;WIRE LIST FILES
	WPCVER__400002	;WPC
EXTPLT__<'PCP'>			;PLOT FILES
	PCPVER__5	;PCP
EXTROU__<'DAT'>			;ROUTER DATA FILES
EXTCRD__<'CRD'>			;EXTENSION FOR PC CARD DEFS
	CRDVER__1		;CRD FILE VERSION NUMBER
>;MPC
UML,<
EXTWDR__<'WDR'>			;DRW WIRE LIST FOR ROUTER GENERATION
	WDRVER__1	;WDR
MD,<
EXTLES__<'LES'>			;LOGIC ERROR SUMMARY FROM WL
	LESVER__1	;LES
		LESWIR__1	;CODE FOR WIRES IN LOGIC ERROR SUMMARY
>;MD
>;UML
EXTSIG__<'SIG'>			;SIGNATURE FILE EXTENTSION
EXTSAV__<'DMP'>			;SAVE FILES
EXTDSK__<'TXT'>			;DISK INPUT/OUTPUT
EXTMCR__<'MCR'>			;MACRO FILE EXTENSION

IFN <WAGSW&UMLSW>!PARTSW,<
DATNAM__<'FOR20 '>		;FORTRAN FILENAME (FOR OUTPT)
IPNNAM__<'FOR23 '>		;IPINS FILENAME DEFAULT
>;....
WAG,<
STRTWR__<'WIRE@ '>		;FIRST WIRE FILE -1
>;WAG
;MORE DEFS

;PIECE OF GLASS ASSIGNMENTS
ANGLPG__1	;FOR DRAWING RIGHT ANGLES
BIGPG__2	;FOR PUTTING OUT BIG B OR P OR S OR L
BLPG__3		;BLINKER PAGE!
MAINPG__4	;MAIN DISPLAY PAGE


;SOME RANDOM TABLE LENGTHS
MPDLEN__100
LHASHP__400	;POINT HASH TABLE (POWER OF TWO)
LHASHB__100	;BODY HASH TABLE (ALSO POWER OF TWO)
SUBTTL MACROS -- SCALE,SCALET,UNSCALE,ADJUST,SWITCH
MD,<PDLEN__2000>
MPC,<PDLEN__5000>
;CHECK FOR INPUT DURING DISPLAYING
DEFINE	CHECKIN
<	XCT CINST
	CAIA
	JRST CHARIN
>

;UPDATE PROGRESS THROUGH DISPLAY ROUTINES
DEFINE SOFAR
<	JSR DSPDSP
	CHECKIN
>

CMU,<
DEFINE XSOFAR
		;CMU MAGIC
<	MOVEM C,CHKSVC
	XCT CINST
	CAIA
	PUSHJ P,XCHRIN
>
>;CMU

;CHANGE SCREEN FOR TEXT OUTPUT
;DEFINE	TVOFF
;<ITS,<	PUSHJ P,.TVOFF >
;>
;
;DEFINE	TVON
;<ITS,<	PUSHJ P,TVMORE >
;>

COMMENT 
There are several systems of coordinates used: INTERNAL, III, PLOT
Internal coords (drawing coords) are usually represented as X*2,,Y*2.
Internal coords are multiplied by the current drawing scale to give display
or plot coords. 
The main drawing scale (NSCALE) applies to all coords except character offsets(?)
	INTERNAL PTS*NSCALE=	PLOT points (shifted 1)
	INTERNAL PTS*NSCALE/4=	D-III points
	INTERNAL PTS*NSCALE/16=	PC-III points

Note that there is a factor of 4 difference between MD-III dpy points
and plot points. When finally output, plot points are further shifted by
1 so that the low bits of each half can be used as markers. When
relating character sizes to plot coords, this total factor of 8 is
accomodated by CSCALE, which is 8 for standard plot outputs.  (CSCALE
may be adjusted by PBOX, if it picks a different scale and wants to
scale the overall character sizes)


Conversions are: 
	UNSCAL:	III points  INTERNAL points
	SCALE:	INTERNAL points  III points
	SCALET:	INTERNAL points  PLOT points


;CONVERT FROM INTERNAL X,Y TO III X,Y
	DEFINE SCALE (AC)
<	IMUL AC,NSCALE
MPC,<	ASH AC,-4	>
MD,<	ASH AC,-2	>
>

;CONVERT FROM INTERNAL X,Y TO P (OR PCP) X,Y
	DEFINE SCALET (AC)
<	IMUL AC,NSCALE
	ASH AC,1
>

;CONVERT FROM III X,Y TO INTERNAL X,Y
	DEFINE UNSCAL (AC)
<
IFDIF<AC><T>
<	PUSH P,T
	MOVE T,AC
>
	PUSHJ P,%UNSCAL
IFDIF<AC><T>
<	MOVE AC,T
	POP P,T
>
>

;ADD 2 HALFWORD X,Y'S (LOW ORDER BIT OFF)
	DEFINE ADJUST(OP,AC,M)
<	IFIDN <OP><SUB><TLO AC,1>
	OP AC,M
	TLZ AC,1
>

;SWITCH SIDES OF PC CARD
	DEFINE SWITCH
<	PUSHJ P,%SWITCH
>
MPC,<
	DEFINE FSWITCH
<
	MOVE T,PHASHP
	EXCH T,PHASH2
	MOVEM T,PHASHP
	SWITCH
>
>;MPC
MD,<DEFINE FSWITCH<SWITCH>>

MD,<
;HERE IS HOW WE HIDE THE PIN NUMBER OFFSET STUFF IN THE X,Y WORD

PXOFF__4000		;JUST GOBBLE 6 BITS FOR NOW
PYOFF__4000
PXMASK__PXOFF*2-1
PYMASK__PYOFF*2-1

DEFINE PXY(AC)
<	AND AC,[PXMASK,,PYMASK]
	TLO AC,1
	SUB AC,[PXOFF,,PYOFF]
	TLZ AC,1
>

DEFINE NXY(AC)
<	ROT AC,4
	ANDI AC,17
>

>;MD

DEFINE	CRLF
<	PUTSTR [ASCIZ /
/]
>
SUBTTL MODES

DEFINE SM(A)
<	A__%MODE
%MODE__%MODE+1
>
%MODE__0

;OUTER (DRAW) LEVEL AND SET MODE
SM	SETM
;OUTER (DRAW) LEVEL AND BODY MODE
SM	BODM
;OUTER (DRAW) LEVEL AND POINT MODE
SM	PNTM
;OUTER (DRAW) LEVEL AND LINE MODE
SM	LINM
;OUTER (DRAW) LEVEL AND POINT TEXT MODE!
SM	TXTM
;ALTER TEXT MODE
SM	ALTM
;ALTER MACRO MODE
SM	MALTM
;SPECIAL POINTER MODE (TEMPRORARY)
SM	SPM
MD,<
;BODY TEXT MODE
SM	BTXTM
;BODY TEXT ALTER MODE
SM	BTALTM
;EDIT LEVEL
SM	EDTM
;EDIT LEVEL AND INSERT MODE
SM	EDTIM
;EDIT LEVEL AND TEXT MODE
SM	EDTTM
;EDIT LEVEL AND PIN MODE
SM	EDTPM
;EDIT LEVEL AND GETTING A BODY
SM	EDTGM
;ALL EDIT MODES (EXCEPT EDTAM)
ALLEDM__1EDTM!1EDTIM!1EDTTM!1EDTPM!1EDTGM
;EDIT MODE ALTER TEXT
SM	EDTAM
>;MD

NUMODES__%MODE

;ALL ALTER MODES
ANYALT__MD,<1EDTAM!1BTALTM!>1MALTM!1ALTM

DEFINE MODISP(BITS,ADDR)
<PUSHJ P,[TRNN B,BITS
	JRST PERRET
	JRST ADDR]
>
C0__1
C1__2
C2__4
C3__10

;DEFINE DEBUGGING STUFF FOR STRUCTURES

DBG,<

.DONE(STRUCTURES)
.DONE(BLOCKS)

%%L__0				;CODES FOR WHERE ELEMENT IS STORED
%%LE__1
%%R__2
%%RE__3
%%FWD__4

..ELEM__0
DEFINE STRUC1 $ (BLOCK,NAME,WHERE)
<	%%$WHERE,,V.$NAME
..ELEM__..ELEM+1
>
ELEMTB:	STRUCTURES		;WHERE TO FETCH,,INDEX INTO STRUCTURE
MAXELM__..ELEM

DEFINE STRUC1 $ (BLOCK,NAME,WHERE)
<	[ASCIZ/NAME/]
>
ELEMNM:	STRUCTURES

DEFINE STRUC1 $ (BLKNAM,NAME,WHERE)
<	BLKNAM
>
ELEMBL:	STRUCTURES



..BLK__0
DEFINE	BLOCK1 $ (NAME)
<	V.$NAME
U.$NAME__..BLK
..BLK__..BLK+1
>
SURLEN:	BLOCKS
MAXSUR__..BLK

DEFINE	BLOCK1 (NAME)
<	<SIXBIT/NAME/>
>
SURNAM:	BLOCKS

FSTLEN__FSTLEN+1		;MAKE ROOM FOR EXTRA WORD OF ID

>;DBG
SUBTTL LOWCOR DATA AREA
;Data in both D and PC
;Begin two prog data areas
;NOTE: Labels in SDATA have explicit ":" so that MIT's @ listing prgm will see those symbols

DEFINE NAMES<

DEC,<
NOPGP,<
SDATA	TMP1:,BOTH
SDATA	TMP2:,BOTH
>;NOPGP
>;DEC
SDATA	EXPER2:,BOTH
SDATA	SIGCHR:,BOTH
SDATA	TPTRP:,BOTH
SDATA	TTPTRP:,BOTH
SDATA	RUNBIT:,BOTH
SDATA	LOW2UP:,BOTH
SDATA	SAVER0:,BOTH
SDATA	SAVERM:,BOTH
SDATA	VARLST:,BOTH
SDATA	WDOLST:,BOTH
SDATA	FNDNUM:,BOTH
SDATA	MOVED:,BOTH
SDATA	HASHP:,BOTH,LHASHP
SDATA	HASHP2:,PC,LHASHP
SDATA	HASHB:,BOTH,LHASHB		;MUST FOLLOW HASHP
SDATA	PHASH2:,PC
SDATA	PHASHP:,BOTH
SDATA	CLAST:,BOTH
SDATA	CLOSES:,BOTH
SDATA	CLOSUP:,BOTH
SDATA	MDISP:,BOTH
SDATA	FBNSTR:,BOTH
SDATA	FBLSTR:,BOTH
SDATA	FBDSTR:,BOTH
SDATA	FPLSTR:,BOTH
SDATA	FPTSTR:,BOTH
SDATA	LSTBOD:,BOTH
SDATA	LSTPNT:,BOTH
SDATA	TPOINT:,BOTH
SDATA	IPOINT:,BOTH
SDATA	LPNTR:,BOTH
SDATA	BLINKN:,BOTH
SDATA	ERRP:,BOTH
SDATA	SAVP:,BOTH
SDATA	FBDLST:,BOTH
SDATA	CORLST:,BOTH
SDATA	OLDTYPE:,BOTH
SDATA	NEWTYPE:,BOTH
SDATA	CURPIN:,BOTH
SDATA	CURDIS:,BOTH
SDATA	CURREP:,BOTH
SDATA	SAVEG:,BOTH
SDATA	STARLOC:,BOTH
SDATA	SPDISP:,BOTH
SDATA	STRING:,BOTH
SDATA	CRDLOC:,BOTH
SDATA	BLBRT:,BOTH
SDATA	REMMAC:,BOTH
SDATA	PINLEV:,BOTH
SDATA	BLPNTR:,BOTH
SDATA	AUTOWM:,BOTH
SDATA	AUTOWN:,BOTH

SDATA	XGO:,BOTH
SDATA	YGO:,BOTH
SDATA	XDISP:,BOTH
SDATA	YDISP:,BOTH
SDATA	COUNT2:,BOTH
SDATA	MACPNT:,BOTH
SDATA	MDPNT:,BOTH
SDATA	VARPNT:,BOTH
SDATA	NDIG:,BOTH
SDATA	SETSTR:,BOTH
SDATA	PUTCHR:,BOTH
SDATA	DSPPSV:,BOTH
SDATA	PLTPSV:,BOTH
SDATA	GTCHRX:,BOTH
SDATA	CDEPPN:,BOTH
SDATA	INPNT:,BOTH
SDATA	FSTPNT:,BOTH
SDATA	MACPDL:,BOTH,MPDLEN
SDATA	PDL:,BOTH,PDLEN
SDATA	NSCALE:,BOTH
SDATA	MODE:,BOTH
SDATA	OMODE:,BOTH
SDATA	DEFBRT:,BOTH
SDATA	L1:,BOTH
SDATA	N1:,BOTH
SDATA	N2:,BOTH
SDATA	L2:,BOTH
SDATA	MAXX:,BOTH
SDATA	MAXY:,BOTH
SDATA	MINX:,BOTH
SDATA	MINY:,BOTH
SDATA	CURBOD:,BOTH
SDATA	CURORT:,BOTH
SDATA	LINING:,BOTH
SDATA	LETTER:,BOTH
SDATA	NUMBER:,BOTH
SDATA	NUMBR1:,BOTH
SDATA	SAVEA:,BOTH
SDATA	SAVEB:,BOTH
SDATA	PGLASS:,BOTH
SDATA	COUNT:,BOTH
SDATA	BITS:,BOTH
SDATA	DIFSOF:,BOTH
SDATA	DY1:,BOTH
SDATA	DY2:,BOTH
SDATA	DY3:,BOTH
SDATA	DX1:,BOTH
SDATA	DX2:,BOTH
SDATA	DX3:,BOTH
SDATA	SETPNT:,BOTH
SDATA	SETFLG:,BOTH
SDATA	ENDBOX:,BOTH
SDATA	TRCBDY:,BOTH
SDATA	TRCTST:,BOTH
SDATA	BUFPTR:,BOTH
SDATA	BFPTR2:,BOTH
SDATA	ALTTFG:,BOTH
SDATA	TTPTR:,BOTH
SDATA	PCHBUF:,BOTH
SDATA	SETBOX:,BOTH
SDATA	NEWSET:,BOTH
SDATA	NEWPNT:,BOTH
SDATA	CRUDLR:,BOTH
SDATA	SIZ:,BOTH
SDATA	BRT:,BOTH
SDATA	CHRCNT:,BOTH
SDATA	LSTNAM:,BOTH
;LSTNAM IS FOLLOWED BY LSTEXT FOR CLRSIG
SDATA	LSTEXT:,BOTH,2
;LSTEXT IS 2 IN LENGTH AND IS FOLLOWED BY LSTPPN, SO CLRSIG CAN
;BE USED TO GET NAME INTO MACRO
SDATA	LSTPPN:,BOTH

SDATA	NEWBOD:,BOTH
SDATA	TYPLOC:,BOTH
SDATA	THSLOC:,BOTH
SDATA	BID:,BOTH
SDATA	PID:,BOTH
SDATA	OLDBID:,BOTH
SDATA	OLDPID:,BOTH
SDATA	MAXBID:,BOTH
SDATA	MAXPID:,BOTH
SDATA	RDVER:,BOTH
SDATA	NNAMES:,BOTH
SDATA	DEFEXT:,BOTH
SDATA	WIRDAT:,BOTH
SDATA	THEREXISTS:,BOTH
SDATA	PERRSAV:,BOTH
SDATA	CURSE:,BOTH
SDATA	LSTCUR:,BOTH
SDATA	CLXY:,BOTH
SDATA	XOFF:,BOTH
SDATA	YOFF:,BOTH
SDATA	TOP:,BOTH
SDATA	BOTTOM:,BOTH
SDATA	LEFT:,BOTH
SDATA	RIGHT:,BOTH
SDATA	DBODPN:,BOTH
SDATA	PONPNT:,BOTH
SDATA	CURSET:,BOTH
SDATA	TOTCNT:,BOTH
SDATA	LINCNT:,BOTH
SDATA	EOLCHR:,BOTH
SDATA	TXTPNT:,BOTH
SDATA	ALTLIN:,BOTH
SDATA	MODALT:,BOTH
SDATA	ALTPNT:,BOTH
SDATA	TXTBYT:,BOTH
SDATA	TXTCNT:,BOTH
SDATA	COMREP:,BOTH
SDATA	NOARG:,BOTH
SDATA	ALTSTR:,BOTH
SDATA	CHRALT:,BOTH
SDATA	FSTART:,BOTH
SDATA	FLEN:,BOTH
SDATA	BEGLIN:,BOTH
SDATA	NOFFST:,BOTH
SDATA	NOPPNF:,BOTH
SDATA	BLKPNT:,BOTH,FSTLEN+1
SDATA	BLKTOP:,BOTH
SDATA	BLKFRE:,BOTH
SDATA	TEXSIZ:,BOTH
SDATA	TEXLIN:,BOTH

ITS,<
SDATA	TVDPY:,BOTH
>;ITS
IFN UMLSW!LAYSW,<
SDATA	OFFERR:,BOTH
SDATA	UPINS:,BOTH
>;IFN UMLSW!LAYSW
UML,<
SDATA	WIRLST:,BOTH
>;UML
>;NAMES
SUBTTL DATA IN ONE OR OTHER
DEFINES NAMES1<

DEFINE FLAGS
<
	FLGMAC	FALSE,BOTH,<JFCL>
	FLGMAC	TRUE,BOTH,<CAIA>
	FLGMAC	CLOSES,BOTH,<PUSHJ P,CLTEST>
	FLGMAC	RITEON,BOTH,<PUSHJ P,ROTEST>
	FLGMAC	EDGE,BOTH
	FLGMAC	AEOL,BOTH
	FLGMAC	ABOL,BOTH
	FLGMAC	FIND,BOTH
	FLGMAC	AFIND,BOTH
	FLGMAC	DSKEND,BOTH
	FLGMAC	ENDMUL,BOTH
	FLGMAC	LSTEXP,BOTH
	FLGMAC	EXPR,BOTH,<PUSHJ P,FEXPR>
>
DEFINE FLGMAC(A,B,C)
<IFIDN<C><><SDATA	A:,B>
>
;GENERATE ANY DATA STATEMENTS FOR SIMPLE FLAGS
	FLAGS

PART,<
SDATA	PARNAM:,D
>;PART
UML,<
SDATA	%LAST:,D
SDATA	ERCODE:,D
>;UML
SDATA	FPSSTR:,D
SDATA	FLNSTR:,D
SDATA	FLDSTR:,D
SDATA	FLPSTR:,D
SDATA	FLTSTR:,D
SDATA	FLRSTR:,D
SDATA	FBTSTR:,D
SDATA	FBRSTR:,D
SDATA	TYPNAM:,D
SDATA	GETLST:,D
SDATA	PKGTEM:,D
SDATA	DEFLST:,D
SDATA	PKGCOD:,D
SDATA	PACK:,D
SDATA	ORIGPN:,D
SDATA	OFFCLC:,D
SDATA	ERRVAR:,D
SDATA	ISVERT:,D
SDATA	MODLIB:,D
SDATA	PONPN2:,PC
SDATA	OUTSIDE:,D
SDATA	SITE1:,D
SDATA	SITE2:,D
SDATA	TIT1:,D
SDATA	TIT2:,D
SDATA	TAUTHOR:,D
SDATA	TREV:,D
SDATA	TMODULE:,D
SDATA	TVARIABLE:,D
SDATA	TPREFIX:,D
SDATA	TPROJ:,D
SDATA	TPAGE:,D
SDATA	TOF:,D
SDATA	TDCODE:,D

DEC,<
SDATA	DRNNAM:,D,4
SDATA	CHKNAM:,D,4
SDATA	ENGNAM:,D,4
SDATA	TNXTHI:,D
>;DEC
SDATA	DRWDAT:,D
SDATA	DRWNAM:,D
SDATA	DRWEXT:,D
SDATA	DRWPPN:,D

SDATA	LIBLST:,D
SDATA	MAPLST:,D
SDATA	LIBTMP:,D
SDATA	DEPTH:,D
SDATA	LIBNAM:,D
SHORT,<
SDATA	SRTLST:,PC
SDATA	SHRTER:,PC
SDATA	SERR1:,PC
SDATA	SERR2:,PC
SDATA	CPLAN1:,PC
SDATA	CPLAN2:,PC
SDATA	PCOP:,PC
SDATA	PTOP:,PC
SDATA	PTOL:,PC
SDATA	LTOL:,PC
>;SHORT
WAG,<
SDATA	LASTWR:,PC
>;WAG
SDATA	CRDNAM:,PC,1,LOW
SDATA	CRDEXT:,PC,1,LOW
SDATA	CRDDAT:,PC,1,LOW
SDATA	CRDPPN:,PC,1,LOW
SDATA	CARDHD:,PC,3,LOW
SDATA	CRDBUF:,PC,406,LOW
SDATA	STPSIZ:,PC
SDATA	CPLANE:,PC
SDATA	XUMLPN:,PC
SDATA	YUMLPN:,PC
SDATA	KEEPIN:,D
SDATA	LOWER:,D
SDATA	UPPER:,D
SDATA	WIDTH:,D
SDATA	EDMODS:,D
SDATA	EDCURS:,D
SDATA	EDSCAL:,D
SDATA	EDXOFF:,D
SDATA	EDYOFF:,D
SDATA	CCW:,D
SDATA	STBPNT:,D
SDATA	STBBDY:,D
SDATA	STBLAS:,D
SDATA	STBSIZ:,D
SDATA	STUBX:,D
SDATA	STUBY:,D
SDATA	CLSTPN:,D
SDATA	CRPPNT:,D
SDATA	BTBODY:,D
SDATA	GETBOD:,D
SDATA	GETORT:,D
SDATA	BODNAM:,D
SDATA	UDLR:,D
SDATA	SAVLOC:,D
SDATA	PINNAM:,D
SDATA	PINS:,D
SDATA	LINES:,D
SDATA	BTEXT:,D
SDATA	TYPE:,D
SDATA	COPPRP:,D
SDATA	BTXLST:,D
SDATA	LOSEPT:,D
SDATA	ODIPTYP:,D
SDATA	DEFOFF:,D
SDATA	DEFOF1:,D
SDATA	DEFBTS:,D
SDATA	UTLIST:,D
SDATA	USEFLG:,D
SDATA	ALLFLG:,D
SDATA	BODPNT:,D
SDATA	SORLST:,D
SDATA	CRDLST:,PC
SDATA	BARLST:,PC

SDATA	CIRC:,D
SDATA	ITSSCL:,D
SDATA	CSCALE:,D
SDATA	LSCALX:,D
SDATA	LSCALY:,D

SDATA	CBOX:,D
SDATA	SSCALE:,D
SDATA	SHEIGHT:,D
SDATA	SWIDTH:,D
SDATA	MOVFLG:,D
SDATA	ULNFLG:,D
SDATA	MXPADN:,PC
SDATA	SIDSAV:,PC
SDATA	BTHBRT:,PC
ROUTE,<
SDATA	ROUIDX:,PC
SDATA	ARRAYA:,PC,%ROW*(%YSIZ/%GRAIN)
SDATA	ARRAYB:,PC,%ROW*(%YSIZ/%GRAIN)
SDATA	RCL1:,PC
SDATA	RCL2:,PC
SDATA	RTCNT:,PC
SDATA	RCODE:,PC
SDATA	ENDBYT:,PC
SDATA	ENDBY2:,PC
SDATA	DX:,PC
SDATA	DY:,PC
SDATA	XCNT:,PC
SDATA	YCNT:,PC
SDATA	RLIST:,PC
SDATA	X1:,PC
SDATA	Y1:,PC
SDATA	X2:,PC
SDATA	Y2:,PC
SDATA	PSAV:,PC
SDATA	.CNR:,PC
SDATA	.FED:,PC
SDATA	.BAK:,PC
SDATA	.SID:,PC
>;ROUTE
>;NAMES1


DEFINE SDATA(LABEL,D.PC,SIZE,SEG)
<
IFIDN<SEG><LOW><STORAGE(LOW);>STORAGE(IMPURE)
IFIDN<D.PC><D><MD,<LABEL	;LABEL HAS : WITH IT
	IFIDN<SIZE><><0>
	IFDIF<SIZE><><BLOCK SIZE>
>>
IFIDN<D.PC><PC><MPC,<LABEL	;LABEL HAS : WITH IT
	IFIDN<SIZE><><0>
	IFDIF<SIZE><><BLOCK SIZE>
>>
IFIDN<D.PC><BOTH><
LABEL				;LABEL HAS : WITH IT
IFIDN<SIZE><><0>
IFDIF<SIZE><><BLOCK SIZE>
>>


SDATA	PATCH:,BOTH,=200	;PATCH SPACE
SDATA	DSPDSP:,BOTH
	JRST @DSPDSP

ZEROBEGIN:

NAMES
NAMES1

ZEROEND__.-1
SUBTTL WIRED-IN DISPLAY DEFINITIONS
;DIP BODY DEFS (PC), BOX TABLES (D)
IFN PCSW!LAYSW,<

NODBG,< DEFINE DBGPTR(EXP)<EXP>  >
DBG,< DEFINE DBGPTR(EXP)<EXP+1>  >

DEFINE %BODY (TAG,NAME,NEXTBOD)
<DBG,<	SIXBIT/TYPE/ >
TAG:	=NAME,,NEXTBOD
	DBGPTR(.+1)
>
DEFINE %PIN  (PINID,X,Y,ENDIFZERO)
<	RADIX =10
DBG,<	SIXBIT/TYPIN/ >
	PINID,,IFIDN <ENDIFZERO><> <DBGPTR(.+2)>
	X/5*2,,Y/5*2
	RADIX 8
>
DEFINE %DIP $ (TAG,Y,DECPINS,LINK)
<DBG,<	SIXBIT/TYPE/ >
TAG:	NUMPINS__=DECPINS
	XWD NUMPINS,LINK
	XWD DBGPTR(L$TAG),DBGPTR(.+1)
NUMPN2__NUMPINS/2
X_(=100*2)/5			;100 MILS IN DISPLAY COORDS (5 MIL STEPS, SHIFTED 1)
XC_-(NUMPN2-1)*X/2		;DISPLACE TO LONGITUDINAL CENTER OF %DIP
YC_=Y/5				;   "    "   LATERAL    "

;PINS
	FOR I_NUMPN2,(NUMPN2)*2-1
<DBG,<	SIXBIT/TYPIN/ >
	XWD I+1,DBGPTR(.+2)
	XWD X*(I-NUMPN2)+XC,-YC
>
	FOR I_0,NUMPN2-2
<DBG,<	SIXBIT/TYPIN/ >
	XWD -I+NUMPN2,DBGPTR(.+2)
	XWD X*I+XC,YC
>
DBG,<	SIXBIT/TYPIN/ >
	XWD 1,0
	XWD X*(NUMPN2-1)+XC,YC
;APPROX BOX
L$TAG:	DBG,<	SIXBIT/QXY/ >
	DBGPTR(.+2)
	XWD X*(NUMPN2-1)+XC,YC
DBG,<	SIXBIT/QXY/ >
	DBGPTR(.+2)
	XWD X*(NUMPN2-1)+XC,-YC
DBG,<	SIXBIT/QXY/ >
	DBGPTR(.+2)
	XWD XC,-YC
DBG,<	SIXBIT/QXY/ >
	DBGPTR(.+2)
	XWD XC,YC
DBG,<	SIXBIT/QXY/ >
	0
	XWD X*(NUMPN2-1)+XC,YC
>;%DIP
STORAGE(IMPURE)
MPC,<BODPNT:	FSTBOD	>

STORAGE(PURE)
;Type definitions (PC)

	%DIP(PIN6,300,6,PIN8)
FSTBOD__PIN6
	%DIP(PIN8,300,8,PIN14)
	%DIP(PIN14,300,14,PIN16)
	%DIP(PIN16,300,16,PIN18)
	%DIP(PIN18,300,18,PIN20)
	%DIP(PIN20,300,20,PIN22)
	%DIP(PIN22,300,22,PIN24)
	%DIP(PIN24,600,24,PIN28)
	%DIP(PIN28,600,28,PIN40)
	%DIP(PIN40,600,40,PIN48)
	%DIP(PIN48,600,48,PIN64)
	%DIP(PIN64,600,64,T018.3)

	%BODY (T018.3,183,T018.4)
	%PIN (1,50,0)
	%PIN (2,0,50)
	%PIN (3,-50,0,0)

	%BODY (T018.4,184,T05.3)
	%PIN (1,50,0)
	%PIN (2,0,50)
	%PIN (3,-50,0)
	%PIN (4,0,-50,0)

	%BODY (T05.3,53,T05.4)
	%PIN (1,100,0)
	%PIN (2,0,100)
	%PIN (3,-100,0,0)

	%BODY (T05.4,54,T066.3)
	%PIN (1,100,0)
	%PIN (2,0,100)
	%PIN (3,-100,0)
	%PIN (4,0,-100,0)

	%BODY (T066.3,663,.3009P)
	%PIN (1,-100,0)
	%PIN (2,100,0)
	%PIN (3,0,580)
	%PIN (4,0,-380,0)

	%BODY (.3009P,30091,PIN3T)
	%PIN (1,-300,0)
	%PIN (2,0,-100)
	%PIN (3,200,0,0)

	%BODY (PIN3T,3,PIN4T)
	%PIN (1,100,0)
	%PIN (2,0,100)
	%PIN (3,-100,0,0)

	%BODY (PIN4T,4,0)
	%PIN (1,50,0)
	%PIN (2,0,50)
	%PIN (3,-50,0)
	%PIN (4,0,-50,0)

>;PCSW!LAYSW

STORAGE(PURE)
MD,<
WTAB:	(AW-=500)/5		;A
	(XW-=500)/5		;X
	(BW-=1000)/5		;B
	(CW-=1000)/5		;C
	(DW-=1000)/5		;D
	(EW-=1000)/5		;E
	(BH-=1000)/5		;VB
	(CH-=1000)/5		;VC
	(DH-=1000)/5		;VD
	(EH-=1000)/5		;VE

HTAB:	(AH-=500-LABH)/5	;A
	(XH-=500-LABX)/5	;X
	(BH-=1000-LABH)/5	;B
	(CH-=1000-LABH)/5	;C
	(DH-=1000-LABH)/5	;D
	(EH-=1000-LABH)/5	;E
	(BW-=1000-LABH)/5	;VB
	(CW-=1000-LABH)/5	;VC
	(DW-=1000-LABH)/5	;VD
	(EW-=1000-LABH)/5	;VE

BTAB:	"A"
	"X"
	"B"
	"C"
DINDEX__.-BTAB
	"D"
	"E"
HBXLEN__.-BTAB
	SETZ "B"
	SETZ "C"
	SETZ "D"
	SETZ "E"
VBXLEN__.-BTAB-HBXLEN
BOXLEN__.-BTAB
>;MD
STORAGE(PURE)
SUBTTL
